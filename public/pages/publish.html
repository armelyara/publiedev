<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">    <link rel="icon" type="image/svg+xml" href="/assets/icons/favicon.svg">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="/css/style.css">
    <title>Soumettre - PublieDev</title>
</head>
<body>
    <!-- Header -->
    <header class="header">
        <div class="container header-content">
            <a href="/" class="logo">
                <div class="logo-icon">
                    <img src="/assets/icons/logo.png" alt="PublieDev" width="20" height="20">
                </div>
                <span>PublieDev</span>
            </a>
            <nav class="nav desktop-only">
                <a href="/pages/explore.html">Explorer</a>
                <div id="authNav">
                    <a href="/pages/login.html" class="btn btn-primary">Connexion</a>
                </div>
            </nav>
        </div>
    </header>

    <main>
        <div class="container" style="padding: 2rem 1rem;">
            <div style="max-width: 54rem; margin: 0 auto;">
                <h1 style="font-size: 2rem; font-weight: 700; margin-bottom: 0.5rem;">Tracer une nouvelle DevRoute</h1>
                <p style="color: var(--gray-600); margin-bottom: 2rem; font-size: 1.1rem;">
                    Documentez votre itin√©raire technique : du probl√®me initial √† la solution d√©ploy√©e.
                    <br><small>‚ö†Ô∏è Rappel : M√©thode "Bo√Æte Noire". D√©crivez la logique, ne soumettez jamais votre code
                        source.</small>
                </p>

                <div id="loadingState" style="text-align: center; padding: 4rem 2rem;">
                    <p style="color: var(--gray-500);">Chargement...</p>
                </div>

                <!-- V√©rification authentification -->
                <div id="authRequired" style="display: none; text-align: center; padding: 4rem 2rem;">
                    <h2 style="margin-bottom: 1rem;">Connexion requise</h2>
                    <p style="color: var(--gray-600); margin-bottom: 1.5rem;">Vous devez √™tre connect√© pour soumettre du contenu.</p>
                    <a href="/pages/login.html" class="btn btn-primary">Se connecter</a>
                </div>

                <!-- Formulaire -->
                <form id="publishForm" style="display: none;">
                    <div id="errorAlert" class="alert alert-error" style="display: none;"></div>
                    <div id="successAlert" class="alert alert-success" style="display: none;"></div>

                    <!-- Type -->
                    <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; margin-bottom: 1rem; border: 1px solid var(--gray-100);">
                        <label style="display: block; font-weight: 500; margin-bottom: 0.75rem;">Type de solution</label>
                        <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 0.5rem;">
                            <button type="button" class="type-btn active" data-type="article">Article</button>
                            <button type="button" class="type-btn" data-type="app-mobile">App Mobile</button>
                            <button type="button" class="type-btn" data-type="app-web">App Web</button>
                            <button type="button" class="type-btn" data-type="api">API</button>
                        </div>
                        <input type="hidden" id="type" value="article">
                    </div>

                    <!-- Champs communs -->
                    <div id="commonFields">
                        <!-- Titre -->
                        <div class="form-group" style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100);">
                            <label for="title">Titre *</label>
                            <input type="text" id="title" placeholder="Nom de votre projet" required>
                        </div>

                        <!-- Description -->
                        <div class="form-group" style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100);">
                            <label for="description">Description courte *</label>
                            <textarea id="description" rows="3" placeholder="D√©crivez bri√®vement votre projet..." required></textarea>
                        </div>
                    </div>

                    <!-- Champs sp√©cifiques Article -->
                    <div id="articleFields" class="type-fields">
                        <div class="form-group" style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100);">
                            <label for="articleAuthors">Auteurs (s√©par√©s par des virgules)</label>
                            <input type="text" id="articleAuthors" placeholder="Nom A, Nom B, Nom C...">
                        </div>

                        <div class="form-group" style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100);">
                            <label for="articleAbstract">R√©sum√© (Abstract) *</label>
                            <textarea id="articleAbstract" rows="5" placeholder="R√©sum√© de l'article..."></textarea>
                        </div>

                        <div class="form-group" style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100);">
                            <label for="articlePdf">Document PDF *</label>
                            <input type="file" id="articlePdf" accept=".pdf">
                            <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">Format PDF uniquement, max 10MB</small>
                        </div>

                        <div class="form-group" style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100);">
                            <label for="articleDoi">DOI (optionnel)</label>
                            <input type="text" id="articleDoi" placeholder="10.1234/exemple">
                        </div>
                    </div>

                    <!-- Champs sp√©cifiques App Mobile -->
                    <div id="appMobileFields" class="type-fields" style="display: none;">
                        <!-- M√âTADONN√âES -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 1rem;">üìã M√âTADONN√âES (Pour le Moteur de Recherche)</h3>

                            <div class="form-group">
                                <label for="mobileCategory">Cat√©gorie *</label>
                                <select id="mobileCategory" required>
                                    <option value="">S√©lectionnez une cat√©gorie</option>
                                    <option value="fintech">FinTech</option>
                                    <option value="agritech">AgriTech</option>
                                    <option value="healthtech">HealthTech</option>
                                    <option value="edtech">EdTech</option>
                                    <option value="ecommerce">E-Commerce</option>
                                    <option value="logistics">Logistique</option>
                                    <option value="communication">Communication</option>
                                    <option value="entertainment">Entertainment</option>
                                    <option value="productivity">Productivit√©</option>
                                    <option value="other">Autre</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="mobileSynopsis">Synopsis Technique (Max 280 caract√®res) *</label>
                                <textarea id="mobileSynopsis" rows="3" maxlength="280" placeholder="R√©sumez votre solution en une phrase pour les r√©sultats de recherche." required></textarea>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;"><span id="mobileSynopsisCount">0</span>/280 caract√®res</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="mobileTags">Stack Technique (Tags s√©par√©s par des virgules) *</label>
                                <input type="text" id="mobileTags" placeholder="Ex: Flutter, Firebase, Google Maps API, Docker" required>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">Entrez les technologies utilis√©es, s√©par√©es par des virgules</small>
                            </div>
                        </div>

                        <!-- √âTAPE 1: LE POINT DE D√âPART -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üéØ √âTAPE 1 : LE POINT DE D√âPART (Le Pourquoi)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Le contexte m√©tier</p>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="mobileDeparture">Le Probl√®me / Besoin *</label>
                                <textarea id="mobileDeparture" rows="6" placeholder="Quel probl√®me pr√©cis avez-vous identifi√© ? Quel √©tait le contexte avant votre solution ?" required></textarea>
                            </div>
                        </div>

                        <!-- √âTAPE 2: LE V√âHICULE & LA CARTE -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üöó √âTAPE 2 : LE V√âHICULE & LA CARTE (Le Comment)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Le c≈ìur technique "Bo√Æte Noire"</p>

                            <div class="form-group">
                                <label for="mobileRoadmap">Architecture & Logique *</label>
                                <textarea id="mobileRoadmap" rows="8" placeholder="‚ö†Ô∏è Ne collez pas de code. Expliquez comment les technologies interagissent. (Ex: 'Le front envoie X au back qui traite Y...')" required></textarea>
                                <small style="color: var(--orange-600); display: block; margin-top: 0.25rem;">‚ö†Ô∏è Pas de code source - expliquez l'architecture en langage naturel</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="mobileArchitectureDiagram">Sch√©ma d'Architecture (Image)</label>
                                <input type="file" id="mobileArchitectureDiagram" accept="image/*">
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">T√©l√©chargez votre diagramme (UML, dessin, sch√©ma). Tr√®s recommand√©.</small>
                            </div>
                        </div>

                        <!-- √âTAPE 3: LES OBSTACLES -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">‚ö†Ô∏è √âTAPE 3 : LES OBSTACLES (Le Processus)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Ce qui fait de ceci un vrai retour d'exp√©rience</p>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="mobileObstacles">D√©fis & Solutions *</label>
                                <textarea id="mobileObstacles" rows="6" placeholder="Sur quoi avez-vous bloqu√© ? (Bug tenace, limitation API, performance). Comment avez-vous r√©solu le probl√®me ?" required></textarea>
                            </div>
                        </div>

                        <!-- √âTAPE 4: LA DESTINATION -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üèÅ √âTAPE 4 : LA DESTINATION (Preuves & Impact)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">La validation finale</p>

                            <div class="form-group">
                                <label for="mobileDestination">R√©sultats & Impact *</label>
                                <textarea id="mobileDestination" rows="4" placeholder="Qu'est-ce que la solution permet de faire aujourd'hui ? Donnez des chiffres si possible (Vitesse, Utilisateurs...)." required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="mobileDemoLink">Lien de D√©mo (Live)</label>
                                <input type="url" id="mobileDemoLink" placeholder="Lien vers le Play Store, App Store ou vid√©o YouTube">
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">Play Store, App Store, ou lien de d√©monstration</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="mobileGallery">Galerie (Screenshots)</label>
                                <input type="file" id="mobileGallery" accept="image/*" multiple>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">Ajoutez 3 √† 5 captures d'√©cran de l'interface. Floutez les donn√©es sensibles.</small>
                            </div>
                        </div>
                    </div>

                    <!-- Champs sp√©cifiques App Web -->
                    <div id="appWebFields" class="type-fields" style="display: none;">
                        <!-- M√âTADONN√âES -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 1rem;">üìã M√âTADONN√âES (Pour le Moteur de Recherche)</h3>

                            <div class="form-group">
                                <label for="webCategory">Cat√©gorie *</label>
                                <select id="webCategory" required>
                                    <option value="">S√©lectionnez une cat√©gorie</option>
                                    <option value="fintech">Fintech & Mobile Money</option>
                                    <option value="agritech">AgriTech</option>
                                    <option value="healthtech">Sant√© & E-Sant√©</option>
                                    <option value="edtech">√âducation & Formation</option>
                                    <option value="ecommerce">E-commerce & Logistique</option>
                                    <option value="transport">Transport & Smart City</option>
                                    <option value="govtech">Services Publics (GovTech)</option>
                                    <option value="ai-data">IA & Data Science</option>
                                    <option value="devtools">Outils D√©veloppeurs (DevTools)</option>
                                    <option value="entertainment">Divertissement & Culture</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="webSynopsis">Synopsis Technique (Max 280 caract√®res) *</label>
                                <textarea id="webSynopsis" rows="3" maxlength="280" placeholder="R√©sumez votre solution en une phrase pour les r√©sultats de recherche." required></textarea>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;"><span id="webSynopsisCount">0</span>/280 caract√®res</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="webTags">Stack Technique (Tags s√©par√©s par des virgules) *</label>
                                <input type="text" id="webTags" placeholder="Ex: React, Node.js, MongoDB, AWS" required>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">Entrez les technologies utilis√©es, s√©par√©es par des virgules</small>
                            </div>
                        </div>

                        <!-- √âTAPE 1: LE POINT DE D√âPART -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üéØ √âTAPE 1 : LE POINT DE D√âPART (Le Pourquoi)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Le contexte m√©tier</p>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="webDeparture">Le Probl√®me / Besoin *</label>
                                <textarea id="webDeparture" rows="6" placeholder="Quel probl√®me pr√©cis avez-vous identifi√© ? Quel √©tait le contexte avant votre solution ?" required></textarea>
                            </div>
                        </div>

                        <!-- √âTAPE 2: LE V√âHICULE & LA CARTE -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üöó √âTAPE 2 : LE V√âHICULE & LA CARTE (Le Comment)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Le c≈ìur technique "Bo√Æte Noire"</p>

                            <div class="form-group">
                                <label for="webRoadmap">Architecture & Logique *</label>
                                <textarea id="webRoadmap" rows="8" placeholder="‚ö†Ô∏è Ne collez pas de code. Expliquez comment les technologies interagissent. (Ex: 'Le front envoie X au back qui traite Y...')" required></textarea>
                                <small style="color: var(--orange-600); display: block; margin-top: 0.25rem;">‚ö†Ô∏è Pas de code source - expliquez l'architecture en langage naturel</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="webArchitectureDiagram">Sch√©ma d'Architecture (Image)</label>
                                <input type="file" id="webArchitectureDiagram" accept="image/*">
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">T√©l√©chargez votre diagramme (UML, dessin, sch√©ma). Tr√®s recommand√©.</small>
                            </div>
                        </div>

                        <!-- √âTAPE 3: LES OBSTACLES -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">‚ö†Ô∏è √âTAPE 3 : LES OBSTACLES (Le Processus)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Ce qui fait de ceci un vrai retour d'exp√©rience</p>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="webObstacles">D√©fis & Solutions *</label>
                                <textarea id="webObstacles" rows="6" placeholder="Sur quoi avez-vous bloqu√© ? (Bug tenace, limitation API, performance). Comment avez-vous r√©solu le probl√®me ?" required></textarea>
                            </div>
                        </div>

                        <!-- √âTAPE 4: LA DESTINATION -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üèÅ √âTAPE 4 : LA DESTINATION (Preuves & Impact)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">La validation finale</p>

                            <div class="form-group">
                                <label for="webDestination">R√©sultats & Impact *</label>
                                <textarea id="webDestination" rows="4" placeholder="Qu'est-ce que la solution permet de faire aujourd'hui ? Donnez des chiffres si possible (Vitesse, Utilisateurs...)." required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="webDemoLink">Lien de D√©mo (Live)</label>
                                <input type="url" id="webDemoLink" placeholder="Lien vers le site web ou vid√©o YouTube">
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">URL du site web en production ou vid√©o de d√©monstration</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="webGallery">Galerie (Screenshots)</label>
                                <input type="file" id="webGallery" accept="image/*" multiple>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">Ajoutez 3 √† 5 captures d'√©cran de l'interface. Floutez les donn√©es sensibles.</small>
                            </div>
                        </div>
                    </div>

                    <!-- Champs sp√©cifiques API -->
                    <div id="apiFields" class="type-fields" style="display: none;">
                        <!-- M√âTADONN√âES -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 1rem;">üìã M√âTADONN√âES (Pour le Moteur de Recherche)</h3>

                            <div class="form-group">
                                <label for="apiCategory">Cat√©gorie *</label>
                                <select id="apiCategory" required>
                                    <option value="">S√©lectionnez une cat√©gorie</option>
                                    <option value="fintech">Fintech & Mobile Money</option>
                                    <option value="agritech">AgriTech</option>
                                    <option value="healthtech">Sant√© & E-Sant√©</option>
                                    <option value="edtech">√âducation & Formation</option>
                                    <option value="ecommerce">E-commerce & Logistique</option>
                                    <option value="transport">Transport & Smart City</option>
                                    <option value="govtech">Services Publics (GovTech)</option>
                                    <option value="ai-data">IA & Data Science</option>
                                    <option value="devtools">Outils D√©veloppeurs (DevTools)</option>
                                    <option value="entertainment">Divertissement & Culture</option>
                                </select>
                            </div>

                            <div class="form-group">
                                <label for="apiSynopsis">Synopsis Technique (Max 280 caract√®res) *</label>
                                <textarea id="apiSynopsis" rows="3" maxlength="280" placeholder="R√©sumez votre solution en une phrase pour les r√©sultats de recherche." required></textarea>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;"><span id="apiSynopsisCount">0</span>/280 caract√®res</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="apiTags">Stack Technique (Tags s√©par√©s par des virgules) *</label>
                                <input type="text" id="apiTags" placeholder="Ex: Node.js, Express, PostgreSQL, Redis" required>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">Entrez les technologies utilis√©es, s√©par√©es par des virgules</small>
                            </div>
                        </div>

                        <!-- √âTAPE 1: LE POINT DE D√âPART -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üéØ √âTAPE 1 : LE POINT DE D√âPART (Le Pourquoi)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Le contexte m√©tier</p>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="apiDeparture">Le Probl√®me / Besoin *</label>
                                <textarea id="apiDeparture" rows="6" placeholder="Quel probl√®me pr√©cis avez-vous identifi√© ? Quel √©tait le contexte avant votre solution ?" required></textarea>
                            </div>
                        </div>

                        <!-- √âTAPE 2: LE V√âHICULE & LA CARTE -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üöó √âTAPE 2 : LE V√âHICULE & LA CARTE (Le Comment)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Le c≈ìur technique "Bo√Æte Noire"</p>

                            <div class="form-group">
                                <label for="apiRoadmap">Architecture & Logique *</label>
                                <textarea id="apiRoadmap" rows="8" placeholder="‚ö†Ô∏è Ne collez pas de code. Expliquez comment les technologies interagissent. (Ex: 'Le front envoie X au back qui traite Y...')" required></textarea>
                                <small style="color: var(--orange-600); display: block; margin-top: 0.25rem;">‚ö†Ô∏è Pas de code source - expliquez l'architecture en langage naturel</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="apiArchitectureDiagram">Sch√©ma d'Architecture (Image)</label>
                                <input type="file" id="apiArchitectureDiagram" accept="image/*">
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">T√©l√©chargez votre diagramme (UML, dessin, sch√©ma). Tr√®s recommand√©.</small>
                            </div>
                        </div>

                        <!-- √âTAPE 3: LES OBSTACLES -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">‚ö†Ô∏è √âTAPE 3 : LES OBSTACLES (Le Processus)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">Ce qui fait de ceci un vrai retour d'exp√©rience</p>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="apiObstacles">D√©fis & Solutions *</label>
                                <textarea id="apiObstacles" rows="6" placeholder="Sur quoi avez-vous bloqu√© ? (Bug tenace, limitation API, performance). Comment avez-vous r√©solu le probl√®me ?" required></textarea>
                            </div>
                        </div>

                        <!-- √âTAPE 4: LA DESTINATION -->
                        <div style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100); margin-bottom: 1.5rem;">
                            <h3 style="font-weight: 600; margin-bottom: 0.5rem;">üèÅ √âTAPE 4 : LA DESTINATION (Preuves & Impact)</h3>
                            <p style="color: var(--gray-600); font-size: 0.875rem; margin-bottom: 1rem;">La validation finale</p>

                            <div class="form-group">
                                <label for="apiDestination">R√©sultats & Impact *</label>
                                <textarea id="apiDestination" rows="4" placeholder="Qu'est-ce que la solution permet de faire aujourd'hui ? Donnez des chiffres si possible (Vitesse, Utilisateurs...)." required></textarea>
                            </div>

                            <div class="form-group">
                                <label for="apiDemoLink">Lien de D√©mo (Live)</label>
                                <input type="url" id="apiDemoLink" placeholder="Lien vers la documentation API ou vid√©o YouTube">
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">URL de la documentation, playground API, ou vid√©o de d√©monstration</small>
                            </div>

                            <div class="form-group" style="margin-bottom: 0;">
                                <label for="apiGallery">Galerie (Screenshots)</label>
                                <input type="file" id="apiGallery" accept="image/*" multiple>
                                <small style="color: var(--gray-500); display: block; margin-top: 0.25rem;">Ajoutez 3 √† 5 captures d'√©cran (docs, postman, r√©ponses). Floutez les donn√©es sensibles.</small>
                            </div>
                        </div>
                    </div>

                    <!-- Cat√©gorie Principale (Obligatoire) -->
                    <div id="categorySection">
                        <div class="form-group" style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100);">
                            <label for="category">Cat√©gorie Principale *</label>
                            <select id="category" required style="width: 100%; padding: 0.75rem; border: 1px solid var(--gray-200); border-radius: 0.5rem; font-size: 1rem; background: var(--white);">
                                <option value="">Choisissez une cat√©gorie...</option>
                                <option value="fintech">Fintech & Mobile Money</option>
                                <option value="agritech">AgriTech</option>
                                <option value="healthtech">Sant√© & E-Sant√© (HealthTech)</option>
                                <option value="edtech">√âducation & Formation (EdTech)</option>
                                <option value="ecommerce">E-commerce & Logistique</option>
                                <option value="transport">Transport & Smart City</option>
                                <option value="govtech">Services Publics & Citoyennet√© (GovTech)</option>
                                <option value="ai-data">Intelligence Artificielle & Data</option>
                                <option value="devtools">Outils D√©veloppeurs (DevTools)</option>
                                <option value="entertainment">Divertissement & Culture</option>
                            </select>
                            <small style="color: var(--gray-500); display: block; margin-top: 0.5rem;">Choisissez le secteur d'activit√© de votre solution, pas la technologie utilis√©e.</small>
                        </div>
                    </div>

                    <!-- Tags & Mots-cl√©s (Libre) -->
                    <div id="tagsSection">
                        <div class="form-group" style="background: var(--white); border-radius: 0.75rem; padding: 1.5rem; border: 1px solid var(--gray-100);">
                            <label for="tags">Tags & Mots-cl√©s (3 √† 8 tags techniques) *</label>
                            <input type="text" id="tags" placeholder="Flutter, Firebase, API Orange Money, YOLOv8, Offline-first..." required>
                            <small style="color: var(--gray-500); display: block; margin-top: 0.5rem;">
                                Ajoutez des tags techniques pr√©cis s√©par√©s par des virgules.
                                <br><strong>Bons exemples:</strong> Flutter, Firebase, API Orange Money, YOLOv8
                                <br><strong>Mauvais exemples:</strong> Super, App, Le futur
                            </small>
                        </div>
                    </div>

                    <!-- Actions -->
                    <div id="actionsSection">
                        <div style="display: flex; justify-content: flex-end; gap: 1rem;">
                            <a href="/" class="btn btn-secondary">Annuler</a>
                            <button type="submit" class="btn btn-primary" id="submitBtn">Soumettre</button>
                        </div>
                    </div>
                </form>
            </div>
        </div>
    </main>

    <style>
        .type-btn {
            padding: 0.75rem;
            border: 1px solid var(--gray-200);
            border-radius: 0.5rem;
            font-size: 0.75rem;
            font-weight: 500;
            background: var(--white);
            transition: all 0.2s;
        }
        .type-btn:hover {
            border-color: var(--bluesky-300);
        }
        .type-btn.active {
            border-color: var(--bluesky-500);
            background: var(--bluesky-50);
            color: var(--bluesky-600);
        }
    </style>

    <!-- Scripts -->
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.0/firebase-storage-compat.js"></script>
    <script src="/js/config.js"></script>
    <script src="/js/services/firebase.js"></script>
    <script src="/js/utils/security.js"></script>
    <script src="/js/services/auth.js"></script>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const form = document.getElementById('publishForm');
            const authRequired = document.getElementById('authRequired');
            const loadingState = document.getElementById('loadingState');
            const errorAlert = document.getElementById('errorAlert');
            const successAlert = document.getElementById('successAlert');
            const submitBtn = document.getElementById('submitBtn');

            // Gestion des compteurs de caract√®res pour chaque type
            const mobileSynopsisInput = document.getElementById('mobileSynopsis');
            const mobileSynopsisCount = document.getElementById('mobileSynopsisCount');
            const webSynopsisInput = document.getElementById('webSynopsis');
            const webSynopsisCount = document.getElementById('webSynopsisCount');
            const apiSynopsisInput = document.getElementById('apiSynopsis');
            const apiSynopsisCount = document.getElementById('apiSynopsisCount');

            if (mobileSynopsisInput && mobileSynopsisCount) {
                mobileSynopsisInput.addEventListener('input', () => {
                    mobileSynopsisCount.textContent = mobileSynopsisInput.value.length;
                });
            }

            if (webSynopsisInput && webSynopsisCount) {
                webSynopsisInput.addEventListener('input', () => {
                    webSynopsisCount.textContent = webSynopsisInput.value.length;
                });
            }

            if (apiSynopsisInput && apiSynopsisCount) {
                apiSynopsisInput.addEventListener('input', () => {
                    apiSynopsisCount.textContent = apiSynopsisInput.value.length;
                });
            }

        // V√©rifier l'authentification (utilise currentUser de auth.js)
        auth.onAuthStateChanged((user) => {
            loadingState.style.display = 'none';
            if (user) {
                form.style.display = 'block';
                authRequired.style.display = 'none';
            } else {
                form.style.display = 'none';
                authRequired.style.display = 'block';
            }
        });

        // Gestion des boutons de type
        document.querySelectorAll('.type-btn').forEach(btn => {
            btn.addEventListener('click', () => {
                document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
                btn.classList.add('active');

                const type = btn.dataset.type;
                document.getElementById('type').value = type;

                // Afficher les champs communs
                document.getElementById('commonFields').style.display = 'block';
                document.getElementById('categorySection').style.display = 'block';
                document.getElementById('tagsSection').style.display = 'block';
                document.getElementById('actionsSection').style.display = 'block';

                // Masquer tous les champs sp√©cifiques ET d√©sactiver la validation
                document.querySelectorAll('.type-fields').forEach(field => {
                    field.style.display = 'none';
                    // D√©sactiver tous les champs required dans les sections masqu√©es
                    field.querySelectorAll('[required]').forEach(input => {
                        input.removeAttribute('required');
                        input.setAttribute('data-was-required', 'true');
                    });
                });

                // Afficher les champs du type s√©lectionn√© ET r√©activer la validation
                const fieldsMap = {
                    'article': 'articleFields',
                    'app-mobile': 'appMobileFields',
                    'app-web': 'appWebFields',
                    'api': 'apiFields'
                };
                const selectedFields = document.getElementById(fieldsMap[type]);
                selectedFields.style.display = 'block';
                // R√©activer les champs required dans la section visible
                selectedFields.querySelectorAll('[data-was-required]').forEach(input => {
                    input.setAttribute('required', '');
                });
            });
        });

        // Soumission du formulaire
        form.addEventListener('submit', async (e) => {
            e.preventDefault();
            await publish();
        });

        // Fonction pour g√©n√©rer les mots-cl√©s de recherche
        function generateKeywords(text) {
            return text.toLowerCase()
                .normalize('NFD').replace(/[\u0300-\u036f]/g, '')
                .split(/\s+/)
                .filter(word => word.length > 2);
        }

        // Fonction pour uploader un fichier
        async function uploadFile(file, path) {
            const storageRef = storage.ref(path);
            await storageRef.put(file);
            return await storageRef.getDownloadURL();
        }

        // Publier
        async function publish() {
            errorAlert.style.display = 'none';
            successAlert.style.display = 'none';
            submitBtn.disabled = true;
            submitBtn.textContent = 'Envoi en cours...';

            try {
                const user = getCurrentUser();
                if (!user) throw new Error('Authentification requise.');

                // R√©cup√©rer le type s√©lectionn√©
                const type = document.getElementById('type').value;

                // Champs communs
                const title = document.getElementById('title').value.trim();
                const description = document.getElementById('description').value.trim();
                const mainCategory = document.getElementById('category').value;
                const mainTagsRaw = document.getElementById('tags').value;
                const mainTags = mainTagsRaw.split(',').map(t => t.trim()).filter(t => t);

                // Validation basique
                if (!title || !description) throw new Error('Titre et description sont requis.');
                if (mainTags.length < 3) throw new Error('Veuillez ajouter au moins 3 tags techniques.');

                // G√©n√©rer le slug
                const slug = title.toLowerCase().replace(/[^a-z0-9]+/g, '-').replace(/(^-|-$)/g, '');

                // Construction de l'objet de base
                const data = {
                    type: type,
                    title: title,
                    description: description,
                    slug: slug,
                    category: mainCategory,
                    tags: mainTags,
                    keywords: generateKeywords(title + ' ' + description + ' ' + mainTags.join(' ')),
                    author: {
                        uid: user.uid,
                        name: user.displayName || 'Utilisateur',
                        email: user.email
                    },
                    status: 'pending',
                    stats: { views: 0, likes: 0 },
                    createdAt: firebase.firestore.FieldValue.serverTimestamp(),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                };

                // Traitement selon le type
                if (type === 'article') {
                    // Article sp√©cifique
                    const authorsRaw = document.getElementById('articleAuthors').value;
                    const abstract = document.getElementById('articleAbstract').value.trim();
                    const doi = document.getElementById('articleDoi').value.trim();
                    const pdfInput = document.getElementById('articlePdf');

                    if (!abstract) throw new Error('Le r√©sum√© (abstract) est requis pour un article.');
                    if (!pdfInput.files.length) throw new Error('Le document PDF est requis pour un article.');

                    const pdfFile = pdfInput.files[0];
                    if (pdfFile.size > 10 * 1024 * 1024) throw new Error('Le fichier PDF ne doit pas d√©passer 10MB.');

                    submitBtn.textContent = 'Upload du PDF...';
                    const pdfUrl = await uploadFile(pdfFile, `articles/${user.uid}/${Date.now()}_${pdfFile.name}`);

                    data.authors = authorsRaw ? authorsRaw.split(',').map(a => a.trim()).filter(a => a) : [];
                    data.abstract = abstract;
                    data.doi = doi;
                    data.pdfUrl = pdfUrl;

                } else if (type === 'app-mobile' || type === 'app-web' || type === 'api') {
                    // DevRoute commun pour les 3 types
                    const prefix = type === 'app-mobile' ? 'mobile' : (type === 'app-web' ? 'web' : 'api');

                    const devCategory = document.getElementById(`${prefix}Category`).value;
                    const synopsis = document.getElementById(`${prefix}Synopsis`).value.trim();
                    const techTagsRaw = document.getElementById(`${prefix}Tags`).value;
                    const departure = document.getElementById(`${prefix}Departure`).value.trim();
                    const roadmap = document.getElementById(`${prefix}Roadmap`).value.trim();
                    const obstacles = document.getElementById(`${prefix}Obstacles`).value.trim();
                    const destination = document.getElementById(`${prefix}Destination`).value.trim();
                    const demoLink = document.getElementById(`${prefix}DemoLink`).value.trim();
                    const diagramInput = document.getElementById(`${prefix}ArchitectureDiagram`);
                    const galleryInput = document.getElementById(`${prefix}Gallery`);

                    // Validation
                    if (!devCategory || !synopsis || !techTagsRaw) {
                        throw new Error('Cat√©gorie, synopsis et tags techniques sont requis.');
                    }
                    if (!departure || !roadmap || !obstacles || !destination) {
                        throw new Error('Les 4 √©tapes de la DevRoute sont requises.');
                    }
                    if (synopsis.length > 280) {
                        throw new Error('Le synopsis ne doit pas d√©passer 280 caract√®res.');
                    }

                    const techTags = techTagsRaw.split(',').map(t => t.trim()).filter(t => t);

                    // Upload du diagramme d'architecture
                    submitBtn.textContent = 'Upload des fichiers...';
                    let architectureDiagramUrl = null;
                    if (diagramInput.files.length > 0) {
                        architectureDiagramUrl = await uploadFile(
                            diagramInput.files[0],
                            `devroutes/${type}/${user.uid}/${Date.now()}_diagram`
                        );
                    }

                    // Upload de la galerie
                    const galleryUrls = [];
                    if (galleryInput.files.length > 0) {
                        for (let i = 0; i < Math.min(galleryInput.files.length, 5); i++) {
                            const url = await uploadFile(
                                galleryInput.files[i],
                                `devroutes/${type}/${user.uid}/${Date.now()}_gallery_${i}`
                            );
                            galleryUrls.push(url);
                        }
                    }

                    // Structure DevRoute
                    data.devRoute = {
                        category: devCategory,
                        synopsis: synopsis,
                        techStack: techTags,
                        steps: {
                            departure: departure,
                            roadmap: roadmap,
                            obstacles: obstacles,
                            destination: destination
                        },
                        media: {
                            architectureDiagram: architectureDiagramUrl,
                            demoLink: demoLink,
                            gallery: galleryUrls
                        }
                    };
                }

                // Enregistrer dans Firestore
                submitBtn.textContent = 'Cr√©ation...';
                await db.collection('publications').add(data);

                // Succ√®s
                successAlert.textContent = 'Votre publication a √©t√© soumise pour validation. Elle sera visible apr√®s approbation.';
                successAlert.style.display = 'block';
                form.reset();

                // R√©initialiser l'interface
                document.querySelectorAll('.type-btn').forEach(b => b.classList.remove('active'));
                document.querySelector('.type-btn[data-type="article"]').classList.add('active');
                document.getElementById('type').value = 'article';

                document.getElementById('commonFields').style.display = 'none';
                document.querySelectorAll('.type-fields').forEach(f => f.style.display = 'none');
                document.getElementById('categorySection').style.display = 'none';
                document.getElementById('tagsSection').style.display = 'none';
                document.getElementById('actionsSection').style.display = 'none';

                submitBtn.disabled = false;
                submitBtn.textContent = 'Soumettre';

                // Scroll vers le haut
                window.scrollTo({ top: 0, behavior: 'smooth' });

            } catch (error) {
                console.error('Erreur:', error);
                errorAlert.textContent = error.message || 'Une erreur est survenue';
                errorAlert.style.display = 'block';
                submitBtn.disabled = false;
                submitBtn.textContent = 'Soumettre';
            }
        }
        }); // End DOMContentLoaded
    </script>

    <!-- Footer -->
    <footer class="footer">
        <div class="container">
            <div class="footer-grid">
                <div class="footer-brand">
                    <a href="/" class="logo">
                        <div class="logo-icon">
                            <img src="/assets/icons/logo.png" alt="PublieDev" width="20" height="20">
                        </div>
                        <span>PublieDev</span>
                    </a>
                    <p>PublieDev, la revue technologique des d√©veloppeurs</p>
                    <div class="social-links">
                        <a href="#" aria-label="GitHub">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M12 0c-6.626 0-12 5.373-12 12 0 5.302 3.438 9.8 8.207 11.387.599.111.793-.261.793-.577v-2.234c-3.338.726-4.033-1.416-4.033-1.416-.546-1.387-1.333-1.756-1.333-1.756-1.089-.745.083-.729.083-.729 1.205.084 1.839 1.237 1.839 1.237 1.07 1.834 2.807 1.304 3.492.997.107-.775.418-1.305.762-1.604-2.665-.305-5.467-1.334-5.467-5.931 0-1.311.469-2.381 1.236-3.221-.124-.303-.535-1.524.117-3.176 0 0 1.008-.322 3.301 1.23.957-.266 1.983-.399 3.003-.404 1.02.005 2.047.138 3.006.404 2.291-1.552 3.297-1.23 3.297-1.23.653 1.653.242 2.874.118 3.176.77.84 1.235 1.911 1.235 3.221 0 4.609-2.807 5.624-5.479 5.921.43.372.823 1.102.823 2.222v3.293c0 .319.192.694.801.576 4.765-1.589 8.199-6.086 8.199-11.386 0-6.627-5.373-12-12-12z"/>
                            </svg>
                        </a>
                        <a href="#" aria-label="Twitter">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M23.953 4.57a10 10 0 01-2.825.775 4.958 4.958 0 002.163-2.723c-.951.555-2.005.959-3.127 1.184a4.92 4.92 0 00-8.384 4.482C7.69 8.095 4.067 6.13 1.64 3.162a4.822 4.822 0 00-.666 2.475c0 1.71.87 3.213 2.188 4.096a4.904 4.904 0 01-2.228-.616v.06a4.923 4.923 0 003.946 4.827 4.996 4.996 0 01-2.212.085 4.936 4.936 0 004.604 3.417 9.867 9.867 0 01-6.102 2.105c-.39 0-.779-.023-1.17-.067a13.995 13.995 0 007.557 2.209c9.053 0 13.998-7.496 13.998-13.985 0-.21 0-.42-.015-.63A9.935 9.935 0 0024 4.59z"/>
                            </svg>
                        </a>
                        <a href="#" aria-label="LinkedIn">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor">
                                <path d="M20.447 20.452h-3.554v-5.569c0-1.328-.027-3.037-1.852-3.037-1.853 0-2.136 1.445-2.136 2.939v5.667H9.351V9h3.414v1.561h.046c.477-.9 1.637-1.85 3.37-1.85 3.601 0 4.267 2.37 4.267 5.455v6.286zM5.337 7.433c-1.144 0-2.063-.926-2.063-2.065 0-1.138.92-2.063 2.063-2.063 1.14 0 2.064.925 2.064 2.063 0 1.139-.925 2.065-2.064 2.065zm1.782 13.019H3.555V9h3.564v11.452zM22.225 0H1.771C.792 0 0 .774 0 1.729v20.542C0 23.227.792 24 1.771 24h20.451C23.2 24 24 23.227 24 22.271V1.729C24 .774 23.2 0 22.222 0h.003z"/>
                            </svg>
                        </a>
                    </div>
                </div>

                <div class="footer-links">
                    <h4>Explorer</h4>
                    <ul>
                        <li><a href="/pages/mobileapp.html">Application Mobile</a></li>
                        <li><a href="/pages/apis.html">APIs</a></li>
                        <li><a href="/pages/webapp.html">Application Web</a></li>
                        <li><a href="/pages/articles.html">Articles</a></li>
                    </ul>
                </div>

                <div class="footer-links">
                    <h4>Ressources</h4>
                    <ul>
                        <li><a href="/pages/about.html">√Ä propos</a></li>
                        <li><a href="/pages/guidelines.html">Directives</a></li>
                        <li><a href="/pages/privacy.html">Confidentialit√©</a></li>
                        <li><a href="/pages/terms.html">Conditions</a></li>
                    </ul>
                </div>
            </div>

            <div class="footer-bottom">
                <p>&copy; 2025 PublieDev. Le mot PublieDev ainsi que le logo "balise de code en blanc sur un fond bleu"
                    sont des marques commerciales de <a href="https://thedayinfo.com/">The Day Info</a>. L'utilisation
                    non-autoris√©e de ces marques est strictement interdite.</p>
        </div>
    </footer>
</body>
</html>
